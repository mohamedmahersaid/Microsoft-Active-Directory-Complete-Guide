________________________________________
ğŸ› ï¸ Active Directory Setup â€” vlab.local
________________________________________

ğŸ‘¥ Lab Environment
Component	Details
Domain Name	vlab.local
Subnet	172.16.1.0/24
Domain Controller	172.16.1.10
DNS Server	Same as DC
Client Machine	172.16.1.100+
OS Version	Windows Server 2019/2022

________________________________________
1ï¸âƒ£ Install and Configure Active Directory Domain Services
________________________________________

ğŸ”Œ Set Static IP Address
New-NetIPAddress -InterfaceAlias "Ethernet" -IPAddress 172.16.1.10 -PrefixLength 24 -DefaultGateway 172.16.1.1
Set-DnsClientServerAddress -InterfaceAlias "Ethernet" -ServerAddresses 172.16.1.10

ğŸ–Šï¸ Rename Computer
Rename-Computer -NewName "HQ-DC01" -Restart

ğŸ• Set Time Zone
Set-TimeZone -Name "Arab Standard Time"

ğŸ—“ï¸ Install AD DS Role

1.	Open Server Manager â†’ click Add Roles and Features â†’ click Next.
2.	Select Role-based or feature-based installation â†’ click Next.
3.	Select this server from the server pool â†’ click Next.
4.	Select Active Directory Domain Services.
5.	When prompted, click Add Features â†’ click Next until Confirmation.
6.	Click Install. Wait for completion, then click Close.

ğŸ—ï¸ Configure Domain Controller
1.	Click the flag notification in Server Manager â†’ Promote this server to a domain controller.
2.	Choose Add a new forest â†’ enter vlab.local as domain name â†’ click Next.
3.	Set DSRM password â†’ click Next.
4.	Ignore DNS delegation warnings â†’ click Next.
5.	Confirm NetBIOS domain name is VLAB â†’ click Next.
6.	Accept default locations for database, log, and SYSVOL folders â†’ click Next.
7.	Review settings â†’ click Next, run prerequisites check, and then Install.
The server will reboot automatically.

âœ… Verify Domain Setup
Get-ADDomain
Get-ADForest

ğŸŒ Configure DNS Forwarders
Add-DnsServerForwarder -IPAddress 8.8.8.8
________________________________________
2ï¸âƒ£ Create Service Accounts
________________________________________
ğŸ‘¤ Add Service Accounts
1.	Open Active Directory Users and Computers â†’ go to vlab.local â†’ Users container.
2.	Right-click â†’ New â†’ User and add:
o	ra-service â†’ set password â†’ mark as "Password never expires"
o	autoenrollmentbind â†’ set password â†’ mark as "Password never expires"
ğŸ‘¥ Group Membership
â€¢	Add autoenrollmentbind to Cert Publishers group.
âš ï¸ Tip: You may use a single account for all services for simplicity, but do not add it to the Protected Users group to avoid LDAP Bind failures.
________________________________________
3ï¸âƒ£ Add Hosts to DNS Service
________________________________________

1.	Open DNS Manager from Server Manager â†’ Tools â†’ DNS.
2.	Expand your server â†’ Forward Lookup Zones â†’ vlab.local.
3.	Right-click â†’ New Host (A or AAAA):
o	Add entries for EJBCA and other servers.
4.	Update the SOA serial number.
________________________________________
4ï¸âƒ£ Install Active Directory Certificate Services Tools
________________________________________

1.	From Server Manager â†’ Manage â†’ Add Roles and Features.
2.	Click Next until Features.
3.	Expand Remote Server Administration Tools â†’ Role Administration Tools.
4.	Check AD Certificate Services Tools â†’ click Next â†’ click Install.
Wait for installation to complete, then click Close.
________________________________________
5ï¸âƒ£ Add a Client to the Domain
________________________________________

On a client machine (e.g. 172.16.1.100):
1.	Set DNS to 172.16.1.10
2.	Rename to CLIENT01
3.	Join domain:
Add-Computer -DomainName "vlab.local" -Credential vlab\administrator -Restart
________________________________________
6ï¸âƒ£ Create OU and First User
________________________________________
New-ADOrganizationalUnit -Name "IT" -Path "DC=vlab,DC=local"

New-ADUser -Name "Mohamed Nada" \
  -SamAccountName "mnada" \
  -UserPrincipalName "mnada@vlab.local" \
  -AccountPassword (ConvertTo-SecureString "P@ssw0rd123" -AsPlainText -Force) \
  -Enabled $true \
  -Path "OU=IT,DC=vlab,DC=local"
________________________________________
7ï¸âƒ£ Health Checks
________________________________________
dcdiag
repadmin /replsummary
________________________________________
âœ… AD setup complete for vlab.local. Next: GPO, Delegation, Trusts, and Advanced Configs.

